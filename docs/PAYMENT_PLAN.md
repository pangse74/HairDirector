
# 💳 결제 및 서비스 플랜 (Payment Strategy)

## 1. 개요
- **결제 모듈**: **Polar** (polar.sh)
- **상품명**: HairDirector Premium Pass (1회권)
- **가격**: **$2.99** (약 4,000원) / 1회

## 2. 이용 정책 (Usage Policy)
- **$2.99 결제 시 1회 분석/생성 가능**
- **1회권**이므로 복잡한 크레딧 차감 로직 없이, 결제 1건당 완벽한 1번의 결과를 보장합니다.

## 3. 환불 정책 (Refund Policy)
**"서비스 실패 시 무조건 자동 환불"** 정책을 적용하여 고객의 결제 리스크를 완전히 제거합니다.

### 자동 환불 트리거 조건 (AND/OR)
1. **분석 단계 실패**: 업로드된 이미지에서 얼굴을 인식하지 못하거나 데이터를 추출하지 못한 경우.
   *또는*
2. **생성 단계 실패**: 헤어스타일 합성 이미지가 정상적으로 생성되지 않은 경우.

### 기술적 구현 시나리오 (단순화된 모델)
```mermaid
graph TD
    A[결제 완료 ($2.99)] --> B{AI 분석 및 생성 시작}
    B -- 성공 --> C[결과 제공 (서비스 종료)]
    B -- 실패 (분석 or 생성) --> D[자동 환불 로직 트리거]
    D --> E[Polar API: 결제 취소/환불 요청]
    E --> F[사용자에게 '오류로 인한 자동 환불' 안내]
```

## 4. UI/UX 흐름 (수정됨)
1. **결제 전**: "1회 정밀 분석권 ($2.99)" + **"실패 시 100% 자동 환불"** 문구 명시.
2. **진행 중**: 실패하면 즉시 "AI 분석에 실패하여 결제가 자동으로 취소되었습니다. 비용이 청구되지 않습니다." 알림.

## 5. 결제 구조 (Polar)
1. **Polar Checkout**: 1회성 결제 링크 사용.
2. **Webhook/Callback**: 결제 성공 시점에 분석 시작.
3. **실패 처리**: 서버(Functions)에서 실패 감지 시 즉시 Refund/Cancel API 호출.
