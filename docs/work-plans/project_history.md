# 헤어핏 AI 서비스 고도화 계획 및 히스토리

## 개요
이 문서는 헤어핏 AI 서비스의 기능 개선, 보안 강화, 사용자 경험 향상을 위한 단계별 계획과 실행 내역을 기록합니다.

---

## 📅 2026-01-29: V2.0 보안 및 기능 고도화 (완료)

### 1. 주요 목표
*   사용자 맞춤형 분석 기능 강화
*   이미지 생성 시 텍스트 발생 보안 이슈 해결
*   분석 데이터의 안전한 백업 및 가시성 확보

### 2. 상세 구현 내역

#### A. 분석 단계 (The Brain - `analyze.ts`)
*   **AI 모델**: `gemini-2.0-flash`
*   **개선 사항**:
    *   단순 얼굴형 판별을 넘어 **비율, 골격, 인상**까지 심층 분석.
    *   프롬프트에 **"PERSONALIZED styling recommendations"** 명령 추가.
    *   **맞춤형 팁(stylingTips)** 및 **전체 인상(overallImpression)** 데이터 필드 신설.

#### B. 생성 단계 (The Hand - `generate.ts`)
*   **AI 모델**: `gemini-3-pro-image-preview`
*   **보안 조치 (텍스트 방지)**:
    *   프롬프트 상단/하단에 이중으로 **"NO TEXT", "Strict Prohibition"** 명령 적용.
    *   순수 이미지만 생성하도록 유도하여 UI 오버레이와 충돌 방지.

#### C. 결과 및 자동 저장 (System - `AnalysisResultView.tsx`)
*   **자동 저장 시스템 구축 (총 5종 순차 저장)**:
    1.  **JSON 데이터**: 분석 원본 데이터 백업 (연구/복구용).
    2.  **원본 그리드**: 글자 없는 깨끗한 3x3 헤어 시뮬레이션 이미지.
    3.  **스타일 그리드**: 앱 UI에서 깔끔한 폰트로 스타일 명칭을 입힌 최종본.
    4.  **분석 요약 카드**: 인스타그램 공유용 카드 뉴스 형태 (얼굴형+팁+비율).
    5.  **전체 리포트**: 상세 분석 내용이 담긴 긴 스크롤 캡처 이미지.
*   **시각화 강화**:
    *   분석 결과를 한눈에 볼 수 있는 **"요약 카드(Summary Card)"** UI 신규 디자인 및 캡처 기능 구현.

---

## 📅 2026-01-29: V2.1 보안 강화 계획 (예정/진행 중)

### 1. 배경
테스트 결과, 프롬프트 제어만으로는 간혹 이미지 내에 미세한 텍스트나 워터마크가 발생하는 경우가 발견됨. 또한 JSON 데이터는 일반 사용자가 보기 어렵다는 피드백 반영.

### 2. 대응 전략

#### A. 물리적 텍스트 커버 (Physical Blocking)
*   **전략**: AI가 주로 텍스트를 생성하는 이미지 하단 영역을 UI 디자인으로 덮어버림.
*   **구현**: 결과 화면의 3x3 그리드 각 셀 하단에 **"스타일 이름표(Label)"**를 불투명 배경으로 배치하여, 혹시 모를 AI의 할루시네이션 텍스트를 물리적으로 가림.

#### B. 분석 가시성 확보 (Visual Report)
*   **전략**: JSON 파일 확인의 어려움을 해소하기 위해 **"분석 요약 카드"** 이미지 저장 기능 도입.
*   **구현**: 
    1.  `AnalysisResultView.tsx` 내부에 캡처 전용 숨김/표시 영역(`summaryCardRef`) 생성.
    2.  얼굴형, 프로필 사진, 3대 비율, 핵심 팁 3가지를 포함한 카드 디자인 구현.
    3.  자동 저장 파이프라인에 해당 카드 캡처 단계를 포함시킴 (위 V2.0 내역에 반영 완료).

---

## 📁 문서 관리 규칙
*   모든 계획 변경 사항은 본 문서에 누적하여 기록한다.
*   날짜별(버전별) 변경 사항을 명확히 구분한다.
*   `docs/work-plans/` 디렉토리 내에 보관하며, 파일명은 `project_history.md`로 관리한다.
